<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ó–∞–Ω—è—Ç–æ—Å—Ç—å —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      max-width: 900px;
      margin: auto;
    }
    h1 {
      text-align: center;
      margin-bottom: 2rem;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
    }
    .section-title {
      margin-top: 2rem;
      font-size: 1.2rem;
      font-weight: bold;
    }
    .place {
      padding: 1rem;
      border: 2px solid #ccc;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.3s;
      text-align: center;
      font-size: 1.1rem;
      white-space: pre-line;
    }
    .free {
      background-color: #e0ffe0;
    }
    .occupied {
      background-color: #ffe0e0;
    }
    .date-info {
      font-size: 0.9rem;
      color: #444;
      margin-top: 0.5rem;
    }
  </style>
</head>
<body>
  <h1>–ó–∞–Ω—è—Ç–æ—Å—Ç—å —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç</h1>

  <div class="section-title">–†–∞–±–æ—á–∏–µ –º–µ—Å—Ç–∞</div>
  <div class="grid" id="main-places"></div>

  <div class="section-title">–ê–¥–º–∏–Ω-–∑–æ–Ω–∞</div>
  <div id="admin-place" class="place"></div>

  <script>
    const mainPlaces = Array.from({ length: 12 }, (_, i) => `–°—Ç–æ–ª ${i + 1}`);
    const adminPlace = '–ê–¥–º–∏–Ω-—Å—Ç–æ–ª';
    const state = JSON.parse(localStorage.getItem('placesState')) || {};

    function promptDates(place) {
      const current = state[place] || {};
      const dateFrom = prompt('–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 21.03.2025):', current.dateFrom || '');
      if (dateFrom === null) return;

      const dateTo = prompt('–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:', current.dateTo || '');
      if (dateTo === null) return;

      state[place] = {
        occupied: true,
        dateFrom,
        dateTo
      };
    }

    const render = () => {
      const mainContainer = document.getElementById('main-places');
      const adminContainer = document.getElementById('admin-place');

      mainContainer.innerHTML = '';

      [...mainPlaces, adminPlace].forEach((place) => {
        const data = state[place] || {};
        const isOccupied = data.occupied;

        const div = document.createElement('div');
        div.className = `place ${isOccupied ? 'occupied' : 'free'}`;
        div.innerHTML = `${place}\n${isOccupied ? '–ó–ê–ù–Ø–¢–û' : '–°–í–û–ë–û–î–ù–û'}`;

        if (isOccupied && data.dateFrom && data.dateTo) {
          div.innerHTML += `\nüìÖ ${data.dateFrom} ‚Üí ${data.dateTo}`;
        }

        div.onclick = () => {
          if (isOccupied) {
            const confirmClear = confirm(`–û—Å–≤–æ–±–æ–¥–∏—Ç—å ${place}?`);
            if (confirmClear) {
              delete state[place];
            }
          } else {
            promptDates(place);
          }
          localStorage.setItem('placesState', JSON.stringify(state));
          render();
        };

        if (place === adminPlace) {
          adminContainer.innerHTML = '';
          adminContainer.replaceWith(div);
          div.id = 'admin-place';
        } else {
          mainContainer.appendChild(div);
        }
      });
    };

    render();
  </script>
</body>
</html>
